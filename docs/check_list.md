# MySQL 等保2.0 自动化检查清单

## 📊 检查项统计
- **总计**：40 项
- **已完成**：0 项  
- **待完成**：40 项
- **高危项**：15 项
- **中危项**：20 项
- **低危项**：5 项

## 📑 检查项分类

### 1. 身份鉴别类（10项）

#### 1.1 密码策略检查
- [ ] **检查项**：密码过期策略
- **等保条款**：8.1.4.2
- **检查方法**：`SELECT @@default_password_lifetime`
- **合规标准**：密码有效期 ≤ 90天
- **风险等级**：🔴 高危
- **修复脚本**：`fix/01_password_expire.sql`

#### 1.2 密码复杂度检查  
- [ ] **检查项**：密码复杂度要求
- **等保条款**：8.1.4.2
- **检查方法**：`SHOW VARIABLES LIKE 'validate_password%'`
- **合规标准**：启用密码复杂度插件
- **风险等级**：🔴 高危
- **修复脚本**：`fix/02_password_complexity.sql`

#### 1.3 空密码用户检查
- [ ] **检查项**：空密码用户
- **等保条款**：8.1.4.2
- **检查方法**：`SELECT user, host FROM mysql.user WHERE authentication_string = ''`
- **合规标准**：不存在空密码用户
- **风险等级**：🔴 高危
- **修复脚本**：`fix/03_empty_password.sql`

### 2. 访问控制类（10项）

#### 2.1 匿名用户检查
- [ ] **检查项**：匿名用户账户
- **等保条款**：8.1.4.3
- **检查方法**：`SELECT user, host FROM mysql.user WHERE user = ''`
- **合规标准**：不存在匿名用户
- **风险等级**：🔴 高危
- **修复脚本**：`fix/04_anonymous_users.sql`

#### 2.2 默认测试数据库检查
- [ ] **检查项**：test数据库权限
- **等保条款**：8.1.4.3
- **检查方法**：`SELECT * FROM mysql.db WHERE Db = 'test'`
- **合规标准**：test数据库无公共访问权限
- **风险等级**：🟡 中危
- **修复脚本**：`fix/05_test_database.sql`

### 3. 安全审计类（8项）

#### 3.1 二进制日志检查
- [ ] **检查项**：二进制日志启用
- **等保条款**：8.1.4.4
- **检查方法**：`SHOW VARIABLES LIKE 'log_bin'`
- **合规标准**：log_bin = ON
- **风险等级**：🟡 中危
- **修复脚本**：`fix/06_binary_log.sql`

#### 3.2 错误日志检查
- [ ] **检查项**：错误日志配置
- **等保条款**：8.1.4.4
- **检查方法**：`SHOW VARIABLES LIKE 'log_error'`
- **合规标准**：已配置错误日志路径
- **风险等级**：🟡 中危
- **修复脚本**：`fix/07_error_log.sql`

...（继续添加剩余33项）

## 🎯 明日计划
- [ ] 开始开发核心检查脚本 `src/checker/mysql_security.py`
- [ ] 实现前10个高危检查项
- [ ] 编写对应的单元测试